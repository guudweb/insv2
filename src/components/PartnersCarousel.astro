---
// Componente PartnersCarousel - Conectado a Strapi
import type { Socio } from '../lib/strapi';
import { getStrapiImageUrl } from '../lib/strapi';

interface Props {
  socios?: Socio[];
}

const { socios: strapiSocios = [] } = Astro.props;

// Fallback a logos estáticos si no hay datos de Strapi
const defaultPartners = [
  { logo: '/images/partner/img_partner_logo_00.jpg', alt: 'Socio 1', link: null },
  { logo: '/images/partner/img_partner_logo_01.jpg', alt: 'Socio 2', link: null },
  { logo: '/images/partner/img_partner_logo_00.jpg', alt: 'Socio 3', link: null },
  { logo: '/images/partner/img_partner_logo_01.jpg', alt: 'Socio 4', link: null },
  { logo: '/images/partner/img_partner_logo_00.jpg', alt: 'Socio 5', link: null },
  { logo: '/images/partner/img_partner_logo_01.jpg', alt: 'Socio 6', link: null },
];

// Usar socios de Strapi si están disponibles, sino usar los por defecto
const partners = strapiSocios.length > 0
  ? strapiSocios.map(socio => ({
      logo: getStrapiImageUrl(socio.logo.url),
      alt: socio.logo.alternativeText || socio.nombre,
      link: socio.enlace
    }))
  : defaultPartners;
---

<div class="container">
  <div class="customers-box">
    <hr>
    <h2>NUESTROS SOCIOS</h2>
    <div class="row">
      <div class="col-lg-12">
        <div id="customers-slider" class="owl-carousel">
          {partners.map((partner) => (
            <div class="mb-4">
              {partner.link ? (
                <a href={partner.link} target="_blank" rel="noopener noreferrer">
                  <img class="img-fluid" src={partner.logo} alt={partner.alt} />
                </a>
              ) : (
                <img class="img-fluid" src={partner.logo} alt={partner.alt} />
              )}
            </div>
          ))}
        </div>
      </div>
    </div>
  </div>
</div>

<script is:inline>
  (function($) {
    $(document).ready(function() {
      if ($("#customers-slider").length) {
        $("#customers-slider").owlCarousel({
          items: 5,
          loop: true,
          margin: 15,
          nav: false,
          dots: false,
          autoplay: true,
          autoplayTimeout: 2500,
          responsive: {
            0: { items: 2 },
            650: { items: 2 },
            768: { items: 3 },
            1000: { items: 4 },
            1200: { items: 5 }
          }
        });
      }
    });
  })(window.jQuery);
</script>
