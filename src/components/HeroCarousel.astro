---
// Hero Carousel component - Conectado a Strapi
import type { HeroSlide } from '../lib/strapi';
import { getStrapiImageUrl } from '../lib/strapi';

interface Props {
	slides?: HeroSlide[];
}

const { slides: heroSlides = [] } = Astro.props;

// Fallback a slides estáticos si no hay datos de Strapi
const defaultSlides = [
	{ image: '/images/accueil/slider-00.jpg' },
	{ image: '/images/accueil/slider-01.jpg' },
	{ image: '/images/accueil/slider-02.jpg' },
	{ image: '/images/accueil/slider-03.jpg' },
	{ image: '/images/accueil/slider-04.jpg' },
	{ image: '/images/accueil/slider-05.jpg' },
	{ image: '/images/accueil/slider-06.jpg' }
];

// Usar slides de Strapi si están disponibles, sino usar los por defecto
const slides = heroSlides.length > 0
	? heroSlides.map(slide => ({
			image: getStrapiImageUrl(slide.imagen.url),
			title: slide.titulo,
			subtitle: slide.subtitulo,
			link: slide.enlace,
			buttonText: slide.textoBoton
		}))
	: defaultSlides;
---

<header class="slider-main">
	<div id="carouselExampleIndicators" class="carousel slide carousel-fade" data-ride="carousel">
		<ol class="carousel-indicators">
			{slides.map((_, index) => (
				<li
					data-target="#carouselExampleIndicators"
					data-slide-to={index}
					class={index === 0 ? 'active' : ''}
				></li>
			))}
		</ol>
		<div class="carousel-inner" role="listbox">
			{slides.map((slide, index) => (
				<div
					class={`carousel-item ${index === 0 ? 'active' : ''}`}
					style={`background-image: url(${slide.image})`}
				>
					{slide.title && (
						<div class="carousel-caption d-none d-md-block">
							{slide.title && <h2>{slide.title}</h2>}
							{slide.subtitle && <p>{slide.subtitle}</p>}
							{slide.link && slide.buttonText && (
								<a href={slide.link} class="btn btn-primary">{slide.buttonText}</a>
							)}
						</div>
					)}
				</div>
			))}
		</div>
		<a class="carousel-control-prev" href="#carouselExampleIndicators" role="button" data-slide="prev">
			<span class="carousel-control-prev-icon" aria-hidden="true"></span>
			<span class="sr-only">Previous</span>
		</a>
		<a class="carousel-control-next" href="#carouselExampleIndicators" role="button" data-slide="next">
			<span class="carousel-control-next-icon" aria-hidden="true"></span>
			<span class="sr-only">Next</span>
		</a>
	</div>
</header>
