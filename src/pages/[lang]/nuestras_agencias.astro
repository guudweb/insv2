---
import BaseLayout from '../../layouts/BaseLayout.astro';
import { getLangFromUrl, useTranslations, getLocalizedPath } from '../../i18n/utils';

const lang = getLangFromUrl(Astro.url);
const t = useTranslations(lang);

const agencias = [
	{
		ciudad: 'Malabo',
		region: t('agencies.insularRegion'),
		imagen: '/images/inseso-sede.webp',
		localidades: [
			{
				nombre: t('agencies.centralOffice') + ' - ' + t('agencies.cityCenter'),
				direccion: t('agencies.cityCenter') + ', Malabo',
				telefono: '+240 XXX XXX XXX',
				email: 'malabo.centro@inseso.gq',
				horario: t('agencies.schedule'),
				coordenadas: { lat: 3.7523, lng: 8.7741 }
			},
			{
				nombre: t('agencies.office') + ' Santa María',
				direccion: 'Barrio Santa María, Malabo',
				telefono: '+240 XXX XXX XXX',
				email: 'malabo.santamaria@inseso.gq',
				horario: t('agencies.schedule'),
				coordenadas: { lat: 3.7500, lng: 8.7800 }
			},
			{
				nombre: t('agencies.office') + ' Malabo 2',
				direccion: 'Malabo 2, Malabo',
				telefono: '+240 XXX XXX XXX',
				email: 'malabo2@inseso.gq',
				horario: t('agencies.schedule'),
				coordenadas: { lat: 3.7480, lng: 8.7720 }
			}
		]
	},
	{
		ciudad: 'Bata',
		region: t('agencies.continentalRegion'),
		localidades: [
			{
				nombre: t('agencies.regionalOffice') + ' - Bata',
				direccion: 'Avenida de la Libertad, Bata',
				telefono: '+240 XXX XXX XXX',
				email: 'bata@inseso.gq',
				horario: t('agencies.schedule'),
				coordenadas: { lat: 1.8639, lng: 9.7622 }
			}
		]
	},
	{
		ciudad: 'Annobón',
		region: t('agencies.insularRegion'),
		localidades: [
			{
				nombre: t('agencies.office') + ' Annobón',
				direccion: 'San Antonio de Palé, Annobón',
				telefono: '+240 XXX XXX XXX',
				email: 'annobon@inseso.gq',
				horario: t('agencies.schedule'),
				coordenadas: { lat: -1.4263, lng: 5.6360 }
			}
		]
	}
];
---

<BaseLayout title={t('agencies.pageTitle')} description={t('agencies.description')} currentPath={getLocalizedPath('/nuestras_agencias', lang)}>
	<!-- Page Header -->
	<div class="page-header-agencias">
		<div class="container">
			<h1>{t('agencies.title')}</h1>
			<p>{t('agencies.subtitle')}</p>
		</div>
	</div>

	<!-- Main Content -->
	<div class="agencias-main">
		<div class="container">
			<!-- Introducción -->
			<div class="intro-section">
				<div class="row align-items-center">
					<div class="col-lg-8">
						<h2>{t('agencies.networkTitle')}</h2>
						<p class="lead">{t('agencies.networkDescription')}</p>
						<p>{t('agencies.servicesDescription')}</p>
					</div>
					<div class="col-lg-4">
						<div class="stats-box">
							<div class="stat-item">
								<div class="stat-number">5</div>
								<div class="stat-label">{t('agencies.offices')}</div>
							</div>
							<div class="stat-item">
								<div class="stat-number">3</div>
								<div class="stat-label">{t('agencies.cities')}</div>
							</div>
						</div>
					</div>
				</div>
			</div>

			<!-- Agencias por Ciudad -->
			{agencias.map((ciudad, index) => (
				<div class="ciudad-section">
					<div class="ciudad-header">
						<div class="ciudad-icon">
							<i class="fas fa-map-marker-alt"></i>
						</div>
						<div class="ciudad-info">
							<h2>{ciudad.ciudad}</h2>
							<p class="region-label">{ciudad.region}</p>
						</div>
						<div class="ciudad-count">
							<span class="badge">{ciudad.localidades.length} {ciudad.localidades.length === 1 ? t('agencies.officeSingular') : t('agencies.officePlural')}</span>
						</div>
					</div>

						<div class="row">
						{ciudad.imagen && (
							<div class="col-lg-6 col-md-6 mb-4">
								<div class="oficina-card sede-card">
									<div class="oficina-header">
										<div class="oficina-icon sede-icon">
											<i class="fas fa-landmark"></i>
										</div>
										<h3>{t('agencies.headquarters')} INSESO {ciudad.ciudad}</h3>
									</div>
									<div class="sede-imagen">
										<img src={ciudad.imagen} alt={`${t('agencies.headquarters')} INSESO ${ciudad.ciudad}`} class="img-fluid" />
									</div>
								</div>
							</div>
						)}
						{ciudad.localidades.map((oficina) => (
							<div class="col-lg-6 col-md-6 mb-4">
								<div class="oficina-card">
									<div class="oficina-header">
										<div class="oficina-icon">
											<i class="fas fa-building"></i>
										</div>
										<h3>{oficina.nombre}</h3>
									</div>
									<div class="oficina-body">
										<div class="oficina-detail">
											<i class="fas fa-map-marker-alt"></i>
											<div>
												<strong>{t('agencies.address')}</strong>
												<p>{oficina.direccion}</p>
											</div>
										</div>
										<div class="oficina-detail">
											<i class="fas fa-phone"></i>
											<div>
												<strong>{t('agencies.phone')}</strong>
												<p><a href={`tel:${oficina.telefono}`}>{oficina.telefono}</a></p>
											</div>
										</div>
										<div class="oficina-detail">
											<i class="fas fa-envelope"></i>
											<div>
												<strong>{t('agencies.email')}</strong>
												<p><a href={`mailto:${oficina.email}`}>{oficina.email}</a></p>
											</div>
										</div>
										<div class="oficina-detail">
											<i class="fas fa-clock"></i>
											<div>
												<strong>{t('agencies.scheduleLabel')}</strong>
												<p>{oficina.horario}</p>
											</div>
										</div>
									</div>
									<div class="oficina-footer">
										<a href={`https://www.google.com/maps?q=${oficina.coordenadas.lat},${oficina.coordenadas.lng}`} target="_blank" class="btn-ver-mapa">
											<i class="fas fa-map"></i> {t('agencies.viewOnMap')}
										</a>
									</div>
								</div>
							</div>
						))}
					</div>
				</div>
			))}

			<!-- Información Adicional -->
			<div class="info-adicional">
				<div class="row">
					<div class="col-lg-4 col-md-6 mb-4">
						<div class="info-card">
							<div class="info-icon">
								<i class="fas fa-question-circle"></i>
							</div>
							<h3>{t('agencies.needHelp')}</h3>
							<p>{t('agencies.needHelpDescription')}</p>
							<a href={getLocalizedPath('/contacto', lang)} class="btn-info">{t('agencies.contact')}</a>
						</div>
					</div>
					<div class="col-lg-4 col-md-6 mb-4">
						<div class="info-card">
							<div class="info-icon">
								<i class="fas fa-file-download"></i>
							</div>
							<h3>{t('agencies.downloadForms')}</h3>
							<p>{t('agencies.downloadFormsDescription')}</p>
							<a href={getLocalizedPath('/descarga_formularios', lang)} class="btn-info">{t('common.download')}</a>
						</div>
					</div>
					<div class="col-lg-4 col-md-6 mb-4">
						<div class="info-card">
							<div class="info-icon">
								<i class="fas fa-calendar-check"></i>
							</div>
							<h3>{t('agencies.appointment')}</h3>
							<p>{t('agencies.appointmentDescription')}</p>
							<a href={getLocalizedPath('/contacto', lang)} class="btn-info">{t('agencies.requestAppointment')}</a>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
</BaseLayout>

<style>
	/* Page Header */
	.page-header-agencias {
		background: linear-gradient(135deg, #8c1b12 0%, #6d2018 100%);
		padding: 4rem 0 3rem;
		margin-bottom: 3rem;
		color: white;
		text-align: center;
	}

	.page-header-agencias h1 {
		font-size: 48px;
		font-weight: 700;
		margin-bottom: 0.5rem;
	}

	.page-header-agencias p {
		font-size: 18px;
		opacity: 0.9;
	}

	/* Main Container */
	.agencias-main {
		padding: 0 0 4rem;
	}

	/* Intro Section */
	.intro-section {
		margin-bottom: 4rem;
		padding-bottom: 3rem;
		border-bottom: 2px solid #f0f0f0;
	}

	.intro-section h2 {
		font-size: 32px;
		font-weight: 700;
		color: #333;
		margin-bottom: 1.5rem;
	}

	.intro-section .lead {
		font-size: 18px;
		color: #555;
		line-height: 1.8;
		margin-bottom: 1rem;
	}

	.intro-section p {
		font-size: 16px;
		color: #666;
		line-height: 1.7;
	}

	/* Stats Box */
	.stats-box {
		background: linear-gradient(135deg, #8c1b12 0%, #6d2018 100%);
		border-radius: 12px;
		padding: 2rem;
		text-align: center;
		box-shadow: 0 8px 24px rgba(140, 27, 18, 0.2);
	}

	.stat-item {
		margin-bottom: 1.5rem;
	}

	.stat-item:last-child {
		margin-bottom: 0;
	}

	.stat-number {
		font-size: 48px;
		font-weight: 700;
		color: white;
		margin-bottom: 0.5rem;
	}

	.stat-label {
		font-size: 16px;
		color: rgba(255, 255, 255, 0.9);
		text-transform: uppercase;
		letter-spacing: 1px;
	}

	/* Ciudad Section */
	.ciudad-section {
		margin-bottom: 4rem;
	}

	/* Sede Card */
	.sede-card {
		height: 100%;
		display: flex;
		flex-direction: column;
	}

	.sede-icon {
		background: linear-gradient(135deg, #8c1b12 0%, #b22222 100%) !important;
	}

	.sede-imagen {
		flex: 1;
		overflow: hidden;
		border-radius: 0 0 12px 12px;
	}

	.sede-imagen img {
		width: 100%;
		height: 100%;
		object-fit: cover;
		min-height: 250px;
	}

	.ciudad-header {
		display: flex;
		align-items: center;
		gap: 1.5rem;
		margin-bottom: 2rem;
		padding: 1.5rem;
		background: #f8f9fa;
		border-radius: 12px;
		border-left: 5px solid #8c1b12;
	}

	.ciudad-icon {
		width: 60px;
		height: 60px;
		background: #8c1b12;
		border-radius: 50%;
		display: flex;
		align-items: center;
		justify-content: center;
		flex-shrink: 0;
	}

	.ciudad-icon i {
		font-size: 28px;
		color: white;
	}

	.ciudad-info {
		flex: 1;
	}

	.ciudad-info h2 {
		font-size: 28px;
		font-weight: 700;
		color: #333;
		margin-bottom: 0.3rem;
	}

	.region-label {
		color: #666;
		font-size: 14px;
		margin: 0;
		text-transform: uppercase;
		letter-spacing: 0.5px;
	}

	.ciudad-count .badge {
		background: #8c1b12;
		color: white;
		padding: 8px 16px;
		border-radius: 20px;
		font-size: 13px;
		font-weight: 600;
	}

	/* Oficina Card */
	.oficina-card {
		background: white;
		border-radius: 12px;
		box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
		overflow: hidden;
		height: 100%;
		display: flex;
		flex-direction: column;
		transition: all 0.3s ease;
	}

	.oficina-card:hover {
		transform: translateY(-5px);
		box-shadow: 0 8px 24px rgba(140, 27, 18, 0.15);
	}

	.oficina-header {
		background: linear-gradient(135deg, #8c1b12 0%, #6d2018 100%);
		color: white;
		padding: 1.5rem;
		display: flex;
		align-items: center;
		gap: 1rem;
	}

	.oficina-icon {
		width: 50px;
		height: 50px;
		background: rgba(255, 255, 255, 0.2);
		border-radius: 50%;
		display: flex;
		align-items: center;
		justify-content: center;
		flex-shrink: 0;
	}

	.oficina-icon i {
		font-size: 22px;
		color: white;
	}

	.oficina-header h3 {
		font-size: 18px;
		font-weight: 700;
		margin: 0;
	}

	.oficina-body {
		padding: 1.5rem;
		flex: 1;
	}

	.oficina-detail {
		display: flex;
		gap: 1rem;
		margin-bottom: 1.5rem;
		align-items: flex-start;
	}

	.oficina-detail:last-child {
		margin-bottom: 0;
	}

	.oficina-detail > i {
		color: #8c1b12;
		font-size: 18px;
		min-width: 20px;
		margin-top: 3px;
	}

	.oficina-detail div {
		flex: 1;
	}

	.oficina-detail strong {
		display: block;
		color: #333;
		font-size: 14px;
		margin-bottom: 0.3rem;
		font-weight: 600;
	}

	.oficina-detail p {
		color: #666;
		font-size: 14px;
		margin: 0;
		line-height: 1.5;
	}

	.oficina-detail a {
		color: #8c1b12;
		text-decoration: none;
		transition: color 0.3s ease;
	}

	.oficina-detail a:hover {
		color: #6d2018;
		text-decoration: underline;
	}

	.oficina-footer {
		padding: 1rem 1.5rem;
		background: #f8f9fa;
		border-top: 1px solid #e0e0e0;
	}

	.btn-ver-mapa {
		display: inline-flex;
		align-items: center;
		justify-content: center;
		gap: 8px;
		background: #8c1b12;
		color: white;
		padding: 10px 20px;
		border-radius: 6px;
		text-decoration: none;
		font-weight: 600;
		font-size: 14px;
		transition: all 0.3s ease;
		width: 100%;
	}

	.btn-ver-mapa:hover {
		background: #6d2018;
		transform: translateY(-2px);
		box-shadow: 0 4px 12px rgba(140, 27, 18, 0.3);
		color: white;
	}

	/* Info Adicional */
	.info-adicional {
		margin-top: 4rem;
		padding-top: 3rem;
		border-top: 2px solid #f0f0f0;
	}

	.info-card {
		background: white;
		border-radius: 12px;
		padding: 2rem;
		text-align: center;
		box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
		height: 100%;
		transition: all 0.3s ease;
	}

	.info-card:hover {
		transform: translateY(-5px);
		box-shadow: 0 8px 24px rgba(140, 27, 18, 0.15);
	}

	.info-icon {
		width: 80px;
		height: 80px;
		background: linear-gradient(135deg, #8c1b12 0%, #6d2018 100%);
		border-radius: 50%;
		display: flex;
		align-items: center;
		justify-content: center;
		margin: 0 auto 1.5rem;
	}

	.info-icon i {
		font-size: 36px;
		color: white;
	}

	.info-card h3 {
		font-size: 20px;
		font-weight: 700;
		color: #333;
		margin-bottom: 1rem;
	}

	.info-card p {
		color: #666;
		font-size: 14px;
		line-height: 1.6;
		margin-bottom: 1.5rem;
	}

	.btn-info {
		display: inline-flex;
		align-items: center;
		justify-content: center;
		background: #8c1b12;
		color: white;
		padding: 10px 24px;
		border-radius: 6px;
		text-decoration: none;
		font-weight: 600;
		font-size: 14px;
		transition: all 0.3s ease;
	}

	.btn-info:hover {
		background: #6d2018;
		transform: translateY(-2px);
		box-shadow: 0 4px 12px rgba(140, 27, 18, 0.3);
		color: white;
	}

	/* Mobile Responsive */
	@media (max-width: 767px) {
		.page-header-agencias {
			padding: 2.5rem 0 2rem;
			margin-bottom: 2rem;
		}

		.page-header-agencias h1 {
			font-size: 32px;
		}

		.page-header-agencias p {
			font-size: 16px;
		}

		.intro-section h2 {
			font-size: 24px;
		}

		.intro-section .lead {
			font-size: 16px;
		}

		.stats-box {
			margin-top: 2rem;
		}

		.ciudad-header {
			flex-direction: column;
			text-align: center;
			gap: 1rem;
		}

		.ciudad-info h2 {
			font-size: 22px;
		}

		.oficina-header {
			flex-direction: column;
			text-align: center;
		}

		.oficina-header h3 {
			font-size: 16px;
		}
	}

	/* Tablet */
	@media (min-width: 768px) and (max-width: 991px) {
		.page-header-agencias h1 {
			font-size: 40px;
		}

		.intro-section h2 {
			font-size: 28px;
		}
	}
</style>
